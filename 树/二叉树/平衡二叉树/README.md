### 平衡二叉树  

平衡二叉树也是二叉搜索树，并且它需要满足如下的性质：

* 任意一个节点的平衡因子的绝对值都不大于1
    * <strong>平衡因子 = 左子树的高度 - 右子树的高度</strong>  

---

### AVL树的插入  

 关于AVL的旋转，先看一下[这篇文档](http://www.cnblogs.com/wangjzh/p/4695790.html)。  
这里要强调的是：<strong>插入节点的时候，如果失衡了，那么在旋转之后，整棵子树的高度是是不变的，因此无需再向上回溯。</strong>  
插入的逻辑是：从插入点开始，向上寻找<strong>失衡点</strong>，如果没有失衡点，则插入结束；否则进行旋转：  

* 对于LL型，<strong>以失衡点的左孩子为轴，将失衡点右旋</strong>
* 对于RR型，<strong>以失衡点的右孩子为轴，将失衡点左旋</strong>
* 对于LR型，<strong>先以失衡点的左孩子的右孩子为轴，将失衡点的左孩子左旋（得到LL型）；接下来像处理LL型一样，以失衡点的左孩子为轴，将失衡点右旋</strong>
* 对于RL型，<strong>先以失衡点的右孩子的左孩子为轴，将失衡点的右孩子右旋（得到RR型）；接下来像处理RR型一样，以失衡的右孩子为轴，将失衡点左旋</strong>

那么如何判断，属于那种类型的旋转呢？  
首先是找到失衡点，如果：  

* 失衡点的平衡因子大于0，并且左孩子的平衡因子大于等于0，则属于LL型
* 失衡点的平衡引子大于0，并且左孩子的平衡引子小于0，则属于LR型
* 失衡点的平衡因子小于0，并且右孩子的平衡引子小于等于0，则属于RR型
* 失衡点的平衡引子小于0，并且右孩子的平衡引子大于0，则属于RL型

关于如何判断失衡点，可以看代码~

---

### AVL树的删除  

二叉查找树删除节点的本质是：使用左子树最右节点 或 右子树最左节点的关键字 来 替代待删除节点的关键字，然后删除左子树的最右节点 或 右子树的最左节点。  

在AVL树中，删除节点的时候，如果导致某个节点失衡，那么需要进行旋转，旋转之后，得到的子树的高度，<strong>可能比删除节点之前的子树的高度减少1，所以可能需要向上回溯。</strong>  

下图是LR型旋转的例子：  
![avl.png](http://images.timd.cn/data-structure/avl.png)  

其中XL代表X的左子树，XR代表X的右子树。<strong>Subtree代表删除节点后，高度降低1的子树</strong>，A是失衡点。  
删除节点前树的高度是h+3，在删除节点、旋转之后，树的高度是h+2。  
也就是说，在这种情形下，旋转之后，整棵子树的高度也降低了1，所以 可以以旋转后的子树的根作为Subtree，继续向上回溯。  
